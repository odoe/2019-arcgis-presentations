<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no" />
    <title>Slider Sandbox</title>

    <style>

      .smartMappingSliders {
        width: 300px;
        height: 400px;
        display: inline-block;
        margin: 20px;
      }

      .horiztontalSliders {
        width: 400px;
        height: 200px;
        display: inline-block;
        margin: 10px;
      }

      .timeSlider {
        width: 800px;
        height: 100px;
        display: inline-block;
        margin: 10px;
        padding-bottom: 50px;
      }

      .histogram {
        width: 500px;
        height: 300px;
        display: inline-block;
        margin: 10px;
        padding-bottom: 50px;
      }

      .title {
        font-size: 24pt;
        padding: 10px;
      }
    </style>

    <link rel="stylesheet" href="https://js.arcgis.com/4.13/esri/themes/light/main.css"/>
    <script src="https://js.arcgis.com/4.13/"></script>

    <script>
      require([
        "esri/widgets/Slider",
        "esri/widgets/HistogramRangeSlider",
        "esri/widgets/TimeSlider",
        "esri/widgets/Histogram",
        "esri/widgets/smartMapping/ColorSlider",
        "esri/widgets/smartMapping/SizeSlider",
        "esri/widgets/smartMapping/ColorSizeSlider",
        "esri/widgets/smartMapping/ClassedColorSlider",
        "esri/widgets/smartMapping/ClassedSizeSlider",
        "esri/widgets/smartMapping/OpacitySlider",
        "esri/widgets/smartMapping/HeatmapSlider",

        "esri/renderers/visualVariables/ColorVariable",
        "esri/renderers/visualVariables/SizeVariable",
        "esri/renderers/visualVariables/OpacityVariable",

      ], function(
        Slider, HistogramRangeSlider, TimeSlider, Histogram, ColorSlider, SizeSlider, ColorSizeSlider, ClassedColorSlider, ClassedSizeSlider, OpacitySlider, HeatmapSlider,
        ColorVariable, SizeVariable, OpacityVariable
      ) {

        const bins100 = [
          {
            minValue: 0,
            maxValue: 0.00529355,
            count: 1
          },
          {
            minValue: 0.00529355,
            maxValue: 0.0105871,
            count: 0
          },
          {
            minValue: 0.0105871,
            maxValue: 0.01588065,
            count: 1
          },
          {
            minValue: 0.01588065,
            maxValue: 0.0211742,
            count: 0
          },
          {
            minValue: 0.0211742,
            maxValue: 0.02646775,
            count: 0
          },
          {
            minValue: 0.02646775,
            maxValue: 0.0317613,
            count: 0
          },
          {
            minValue: 0.0317613,
            maxValue: 0.03705485,
            count: 4
          },
          {
            minValue: 0.03705485,
            maxValue: 0.0423484,
            count: 4
          },
          {
            minValue: 0.0423484,
            maxValue: 0.04764195,
            count: 11
          },
          {
            minValue: 0.04764195,
            maxValue: 0.0529355,
            count: 17
          },
          {
            minValue: 0.0529355,
            maxValue: 0.05822905,
            count: 24
          },
          {
            minValue: 0.05822905,
            maxValue: 0.0635226,
            count: 37
          },
          {
            minValue: 0.0635226,
            maxValue: 0.06881615,
            count: 27
          },
          {
            minValue: 0.06881615,
            maxValue: 0.0741097,
            count: 39
          },
          {
            minValue: 0.0741097,
            maxValue: 0.07940325,
            count: 62
          },
          {
            minValue: 0.07940325,
            maxValue: 0.0846968,
            count: 58
          },
          {
            minValue: 0.0846968,
            maxValue: 0.08999035,
            count: 76
          },
          {
            minValue: 0.08999035,
            maxValue: 0.0952839,
            count: 68
          },
          {
            minValue: 0.0952839,
            maxValue: 0.10057745,
            count: 92
          },
          {
            minValue: 0.10057745,
            maxValue: 0.105871,
            count: 89
          },
          {
            minValue: 0.105871,
            maxValue: 0.11116455,
            count: 115
          },
          {
            minValue: 0.11116455,
            maxValue: 0.1164581,
            count: 95
          },
          {
            minValue: 0.1164581,
            maxValue: 0.12175165,
            count: 131
          },
          {
            minValue: 0.12175165,
            maxValue: 0.1270452,
            count: 105
          },
          {
            minValue: 0.1270452,
            maxValue: 0.13233875,
            count: 117
          },
          {
            minValue: 0.13233875,
            maxValue: 0.1376323,
            count: 128
          },
          {
            minValue: 0.1376323,
            maxValue: 0.14292585,
            count: 111
          },
          {
            minValue: 0.14292585,
            maxValue: 0.1482194,
            count: 106
          },
          {
            minValue: 0.1482194,
            maxValue: 0.15351295,
            count: 101
          },
          {
            minValue: 0.15351295,
            maxValue: 0.1588065,
            count: 123
          },
          {
            minValue: 0.1588065,
            maxValue: 0.16410005,
            count: 104
          },
          {
            minValue: 0.16410005,
            maxValue: 0.1693936,
            count: 98
          },
          {
            minValue: 0.1693936,
            maxValue: 0.17468715,
            count: 107
          },
          {
            minValue: 0.17468715,
            maxValue: 0.1799807,
            count: 105
          },
          {
            minValue: 0.1799807,
            maxValue: 0.18527425,
            count: 99
          },
          {
            minValue: 0.18527425,
            maxValue: 0.1905678,
            count: 77
          },
          {
            minValue: 0.1905678,
            maxValue: 0.19586135,
            count: 75
          },
          {
            minValue: 0.19586135,
            maxValue: 0.2011549,
            count: 65
          },
          {
            minValue: 0.2011549,
            maxValue: 0.20644845,
            count: 61
          },
          {
            minValue: 0.20644845,
            maxValue: 0.211742,
            count: 66
          },
          {
            minValue: 0.211742,
            maxValue: 0.21703555,
            count: 69
          },
          {
            minValue: 0.21703555,
            maxValue: 0.2223291,
            count: 35
          },
          {
            minValue: 0.2223291,
            maxValue: 0.22762265,
            count: 47
          },
          {
            minValue: 0.22762265,
            maxValue: 0.2329162,
            count: 41
          },
          {
            minValue: 0.2329162,
            maxValue: 0.23820975,
            count: 33
          },
          {
            minValue: 0.23820975,
            maxValue: 0.2435033,
            count: 36
          },
          {
            minValue: 0.2435033,
            maxValue: 0.24879685,
            count: 34
          },
          {
            minValue: 0.24879685,
            maxValue: 0.2540904,
            count: 26
          },
          {
            minValue: 0.2540904,
            maxValue: 0.25938395,
            count: 28
          },
          {
            minValue: 0.25938395,
            maxValue: 0.2646775,
            count: 24
          },
          {
            minValue: 0.2646775,
            maxValue: 0.26997105,
            count: 25
          },
          {
            minValue: 0.26997105,
            maxValue: 0.2752646,
            count: 19
          },
          {
            minValue: 0.2752646,
            maxValue: 0.28055815,
            count: 10
          },
          {
            minValue: 0.28055815,
            maxValue: 0.2858517,
            count: 7
          },
          {
            minValue: 0.2858517,
            maxValue: 0.29114525,
            count: 11
          },
          {
            minValue: 0.29114525,
            maxValue: 0.2964388,
            count: 10
          },
          {
            minValue: 0.2964388,
            maxValue: 0.30173235,
            count: 7
          },
          {
            minValue: 0.30173235,
            maxValue: 0.3070259,
            count: 9
          },
          {
            minValue: 0.3070259,
            maxValue: 0.31231945,
            count: 9
          },
          {
            minValue: 0.31231945,
            maxValue: 0.317613,
            count: 6
          },
          {
            minValue: 0.317613,
            maxValue: 0.32290655,
            count: 10
          },
          {
            minValue: 0.32290655,
            maxValue: 0.3282001,
            count: 7
          },
          {
            minValue: 0.3282001,
            maxValue: 0.33349365,
            count: 2
          },
          {
            minValue: 0.33349365,
            maxValue: 0.3387872,
            count: 3
          },
          {
            minValue: 0.3387872,
            maxValue: 0.34408075,
            count: 4
          },
          {
            minValue: 0.34408075,
            maxValue: 0.3493743,
            count: 1
          },
          {
            minValue: 0.3493743,
            maxValue: 0.35466785,
            count: 4
          },
          {
            minValue: 0.35466785,
            maxValue: 0.3599614,
            count: 5
          },
          {
            minValue: 0.3599614,
            maxValue: 0.36525495,
            count: 0
          },
          {
            minValue: 0.36525495,
            maxValue: 0.3705485,
            count: 1
          },
          {
            minValue: 0.3705485,
            maxValue: 0.37584205,
            count: 3
          },
          {
            minValue: 0.37584205,
            maxValue: 0.3811356,
            count: 2
          },
          {
            minValue: 0.3811356,
            maxValue: 0.38642915,
            count: 4
          },
          {
            minValue: 0.38642915,
            maxValue: 0.3917227,
            count: 1
          },
          {
            minValue: 0.3917227,
            maxValue: 0.39701625,
            count: 1
          },
          {
            minValue: 0.39701625,
            maxValue: 0.4023098,
            count: 0
          },
          {
            minValue: 0.4023098,
            maxValue: 0.40760335,
            count: 1
          },
          {
            minValue: 0.40760335,
            maxValue: 0.4128969,
            count: 0
          },
          {
            minValue: 0.4128969,
            maxValue: 0.41819045,
            count: 1
          },
          {
            minValue: 0.41819045,
            maxValue: 0.423484,
            count: 2
          },
          {
            minValue: 0.423484,
            maxValue: 0.42877755,
            count: 0
          },
          {
            minValue: 0.42877755,
            maxValue: 0.4340711,
            count: 1
          },
          {
            minValue: 0.4340711,
            maxValue: 0.43936465,
            count: 1
          },
          {
            minValue: 0.43936465,
            maxValue: 0.4446582,
            count: 1
          },
          {
            minValue: 0.4446582,
            maxValue: 0.44995175,
            count: 1
          },
          {
            minValue: 0.44995175,
            maxValue: 0.4552453,
            count: 0
          },
          {
            minValue: 0.4552453,
            maxValue: 0.46053885,
            count: 0
          },
          {
            minValue: 0.46053885,
            maxValue: 0.4658324,
            count: 0
          },
          {
            minValue: 0.4658324,
            maxValue: 0.47112595,
            count: 0
          },
          {
            minValue: 0.47112595,
            maxValue: 0.4764195,
            count: 0
          },
          {
            minValue: 0.4764195,
            maxValue: 0.48171305,
            count: 0
          },
          {
            minValue: 0.48171305,
            maxValue: 0.4870066,
            count: 0
          },
          {
            minValue: 0.4870066,
            maxValue: 0.49230015,
            count: 0
          },
          {
            minValue: 0.49230015,
            maxValue: 0.4975937,
            count: 0
          },
          {
            minValue: 0.4975937,
            maxValue: 0.50288725,
            count: 0
          },
          {
            minValue: 0.50288725,
            maxValue: 0.5081808,
            count: 0
          },
          {
            minValue: 0.5081808,
            maxValue: 0.51347435,
            count: 0
          },
          {
            minValue: 0.51347435,
            maxValue: 0.5187679,
            count: 0
          },
          {
            minValue: 0.5187679,
            maxValue: 0.5240614499999999,
            count: 0
          },
          {
            minValue: 0.5240614499999999,
            maxValue: 0.5293549999999999,
            count: 1
          }
        ];

        

        var colorVar = ColorVariable.fromJSON({
          type: "colorInfo",
          field: "POP_POVERTY",
          normalizationField: "TOTPOP_CY",
          stops: [
            {
              "color": [
                255,
                252,
                212,
                255
              ],
              "label": "< 0.1",
              "value": 0.1
            },
            {
              "color": [
                231,
                174,
                157,
                255
              ],
              "value": 0.129
            },
            {
              "color": [
                206,
                96,
                101,
                255
              ],
              "label": "0.158",
              "value": 0.158
            },
            {
              "color": [
                136,
                49,
                79,
                255
              ],
              "value": 0.188
            },
            {
              "color": [
                66,
                2,
                57,
                255
              ],
              "label": "> 0.218",
              "value": 0.218
            }
          ]
        });

        var aboveBelowColorVar = ColorVariable.fromJSON({
          "type": "colorInfo",
          "field": "POP_POVERTY",
          "normalizationField": "TOTPOP_CY",
          "stops": [
            {
              "color": [
                0,
                66,
                56,
                255
              ],
              "label": "< 0.1",
              "value": 0.1
            },
            {
              "color": [
                128,
                161,
                156,
                255
              ],
              "value": 0.129
            },
            {
              "color": [
                255,
                255,
                255,
                255
              ],
              "label": "0.158",
              "value": 0.158
            },
            {
              "color": [
                210,
                153,
                139,
                255
              ],
              "value": 0.188
            },
            {
              "color": [
                165,
                50,
                23,
                255
              ],
              "label": "> 0.218",
              "value": 0.218
            }
          ]
        });
        
        function createContainer(sliderInstance, cssClass){
          sliderInstance.container = document.createElement("div");
          const outerContainer = document.createElement("div");
          outerContainer.classList.add(cssClass);

          const titleContainer = document.createElement("div");
          titleContainer.classList.add("esri-widget");
          titleContainer.classList.add("title");
          titleContainer.innerHTML = sliderInstance.label;

          if(sliderInstance.primaryHandleEnabled){
            titleContainer.innerHTML += " (synced handles)";
          }

          outerContainer.appendChild(titleContainer);
          outerContainer.appendChild(sliderInstance.container);
          const body = document.getElementsByTagName("body")[0];
          body.appendChild(outerContainer);
        }

       const sliders = [
          
          new Slider({
            labelsVisible: true,
            labelInputsEnabled: true,
            rangeLabelsVisible: true,
            rangeLabelInputsEnabled: true,
            layout: "horizontal",
            min: 0,
            max: 10,
            values: [5, 8],
            tickConfigs: [
              {
                mode: "percent",
                values: [20, 40, 60, 80],
                labelsVisible: true
              }
            ]
          }),

          new TimeSlider({
            mode: "time-window",
            loop: true,
            playRate: 100,
            timeVisible: false,
            fullTimeExtent: {
              start: new Date(1990, 0, 1),
              end: new Date(2000, 0, 1)
            },
            values: [
              new Date(1990, 0, 1),
              new Date(1991, 0, 1)
            ],
            stops: {
              count: 20
            }
          }),
          

          new HistogramRangeSlider({
            average: 0.15,
            bins: bins100,
            min: 0,
            max: 0.529354,
            values: [0.1, 0.4],
            rangeType: "between",
            dataLines: [{
              value: 0.4,
              label: "Top 1%"
            }],
            standardDeviation: 0.1,
            standardDeviationCount: 1
          }),

          new ColorSlider({
            min: 0,
            max: 0.529355,
            primaryHandleEnabled: false,
            stops: colorVar.stops,
            histogramConfig: {
              bins: bins100,
              average: 0.158,
              standardDeviation: 0.058,
              standardDeviationCount: 1,
              dataLines: [{
                value: 0.4,
                label: "Top 1%"
              }],
              dataLineCreatedFunction: function( lineElement, labelElement, index ) {
                if (index != null && index <= 1) {
                  // lineElement.setAttribute("x2", "66%");
                  const sign = index === 0 ? "-" : "+";
                  labelElement.innerHTML = sign + "σ";
                }
              }
            }
          }),

          new ColorSlider({
            min: 0,
            max: 0.529355,
            primaryHandleEnabled: true,
            stops: aboveBelowColorVar.stops,
            histogramConfig: {
              bins: bins100,
              average: 0.158,
              standardDeviation: 0.058,
              standardDeviationCount: 1,
              dataLines: [{
                value: 0.4,
                label: "Top 1%"
              }],
              dataLineCreatedFunction: function( lineElement, labelElement, index ) {
                if (index != null && index <= 1) {
                  // lineElement.setAttribute("x2", "66%");
                  const sign = index === 0 ? "-" : "+";
                  labelElement.innerHTML = sign + "σ";
                }
              }
            }
          }),
          
          new SizeSlider({
            min: 0,
            max: 0.529355,
            stops: [
              { value: 0, size: 1 },
              { value: 0.529355, size: 10 } // blue
            ],
            histogramConfig: {
              bins: bins100,
              average: 0.158,
              standardDeviation: 0.058,
              standardDeviationCount: 1,
              dataLines: [{
                value: 0.4,
                label: "Top 1%"
              }],
              dataLineCreatedFunction: function( lineElement, labelElement, index ) {
                if (index != null && index <= 1) {
                  // lineElement.setAttribute("x2", "66%");
                  const sign = index === 0 ? "-" : "+";
                  labelElement.innerHTML = sign + "σ";
                }
              }
            }
          }),
          
          new ColorSizeSlider({
            min: 0,
            max: 0.529355,
            stops: [
              { color: "#FFFCD4", label: "> 5", value: 0.1, size: 1 }, // sand
              { color: "#a1dab4", label: "10", value: 0.129 },
              { color: "#41b6c4", label: "15", value: 0.158 }, // teal
              { color: "#2c7fb8", label: "20", value: 0.188 },
              { color: "#253494", label: "< 25", value: 0.215, size: 10 } // blue
            ],
            histogramConfig: {
              bins: bins100,
              average: 0.158,
              standardDeviation: 0.058,
              standardDeviationCount: 1,
              dataLines: [{
                value: 0.4,
                label: "Top 1%"
              }],
              dataLineCreatedFunction: function( lineElement, labelElement, index ) {
                if (index != null && index <= 1) {
                  // lineElement.setAttribute("x2", "66%");
                  const sign = index === 0 ? "-" : "+";
                  labelElement.innerHTML = sign + "σ";
                }
              }
            }
          }),
          
          new ClassedColorSlider({
        // max: 60,
            breaks: [
              { color: "#FFFCD4", min: 0, max: .1 }, // sand
              { color: "#a1dab4", min: .1, max: .2 },
              { color: "#41b6c4", min: .2, max: 0.3 }, // teal
              { color: "#2c7fb8", min: 0.3, max: .4 },
              { color: "#253494", min: 0.4, max: 0.5 } // blue
            ],
            histogramConfig: {
              bins: bins100,
              average: 0.158,
              standardDeviation: 0.058,
              standardDeviationCount: 1,
              dataLines: [{
                value: 0.4,
                label: "Top 1%"
              }],
              dataLineCreatedFunction: function( lineElement, labelElement, index ) {
                if (index != null && index <= 1) {
                  // lineElement.setAttribute("x2", "66%");
                  const sign = index === 0 ? "-" : "+";
                  labelElement.innerHTML = sign + "σ";
                }
              }
            }
          }),
          
          new ClassedSizeSlider({
            // max: 60,
            breaks: [
              { size: 6, min: 0, max: .1 }, // sand
              { size: 12, min: .1, max: .2 },
              { size: 18, min: .2, max: 0.3 }, // teal
              { size: 24, min: 0.3, max: .4 },
              { size: 36, min: 0.4, max: 0.5 } // blue
            ],
            histogramConfig: {
              bins: bins100,
              average: 0.158,
              standardDeviation: 0.058,
              standardDeviationCount: 1,
              dataLines: [{
                value: 0.4,
                label: "Top 1%"
              }],
              dataLineCreatedFunction: function( lineElement, labelElement, index ) {
                if (index != null && index <= 1) {
                  // lineElement.setAttribute("x2", "66%");
                  const sign = index === 0 ? "-" : "+";
                  labelElement.innerHTML = sign + "σ";
                }
              }
            }
          }),
          
          new OpacitySlider({
            min: 0,
            max: 0.529355,
            stops: [
              { opacity: 0.2, label: "> 5", value: 0.1, size: 1 }, // sand
              { opacity: 0.2, label: "10", value: 0.129 },
              { opacity: 0.4, label: "15", value: 0.158 }, // teal
              { opacity: 0.6, label: "20", value: 0.288 },
              { opacity: 1, label: "< 25", value: 0.415, size: 10 } // blue
            ],
            histogramConfig: {
              bins: bins100,
              average: 0.158,
              standardDeviation: 0.058,
              standardDeviationCount: 1,
              dataLines: [{
                value: 0.4,
                label: "Top 1%"
              }],
              dataLineCreatedFunction: function( lineElement, labelElement, index ) {
                if (index != null && index <= 1) {
                  // lineElement.setAttribute("x2", "66%");
                  const sign = index === 0 ? "-" : "+";
                  labelElement.innerHTML = sign + "σ";
                }
              }
            }
          }),
          
          new HeatmapSlider({
            stops: [
              { color: "#85c1c8", ratio: 0 },
              { color: "#90a1be", ratio: 0.083 },
              { color: "#9c8184", ratio: 0.166 },
              { color: "#a761aa", ratio: 0.249 },
              { color: "#af4980", ratio: 0.332 },
              { color: "#b83055", ratio: 0.415 },
              { color: "#c0182a", ratio: 0.498 },
              { color: "#c80000", ratio: 0.581 },
              { color: "#d33300", ratio: 0.664 },
              { color: "#de6600", ratio: 0.747 },
              { color: "#e99900", ratio: 0.83 },
              { color: "#f4cc00", ratio: 0.913 },
              { color: "#ffff00", ratio: 1 }
            ]
          }),

          new Histogram({
            min: 0,
            max: 0.529,
            bins: bins100,
            average: 0.158,
            dataLines: [{
              value: 0.4,
              label: "Top 1%"
            }]
          })
        ];

        sliders.forEach(function(slider, i){
          let cssClass = "smartMappingSliders";

          if (slider.declaredClass === "esri.widgets.TimeSlider"){
            cssClass = "timeSlider";
          }

          if (slider.declaredClass === "esri.widgets.Histogram"){
            cssClass = "histogram";
          }

          if (slider.declaredClass === "esri.widgets.Slider" || slider.declaredClass === "esri.widgets.HistogramRangeSlider"){
            cssClass = "horiztontalSliders"
          }
          createContainer(slider, cssClass);
        });

       
      });
    </script>
  </head>

  <body>
  </body>
</html>
